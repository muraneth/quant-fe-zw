#user  nobody;
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    gzip  on;

    server {
        # html: no-cache
        location ~ .*\.html?$ {
            root /static; 
            add_header 'Access-Control-Allow-Origin' '*';
            add_header Cache-Control "public, no-cache";
        }

        # 非 html: 强缓存半年
        location ~ .*.(js|css|png|jpg|jpeg|svg|eot|woff2|ttf)$ {
            root /static;  
            add_header 'Access-Control-Allow-Origin' '*';
            add_header Cache-Control "public, max-age=15552000";
        }

        location / {
            root /static;
            index index.html;
            
            # 处理 spa 导致的 404 问题, 当 spa 路由找不到时，重定向会 index.html
            try_files $uri /index.html;
        }
    }
}
