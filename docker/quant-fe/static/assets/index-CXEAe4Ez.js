import{j as n,c as De,T as Ne,L as Ye,D as Oe}from"./material-Bhy9WmQB.js";import{c as Be,a as $e,i as Le,u as ae,g as pe,b as P,s as Y,r as N,f as T,d as V,A as Ee,e as Re,h as ge,j as ze}from"./index-Cdglh908.js";import{x as G,aH as re,aD as S,aI as Fe,aC as We,G as Ue,Y as He,aJ as Ge,O as fe,g as ye,_ as Ve,R as qe,a6 as Ke,aK as Xe,U as Je,W as Ze}from"./vendor-BYJWZVdn.js";import{w as Qe,a as et,c as tt,u as st,F as nt}from"./form-render-BWbW7Kj7.js";const ce={tokenInfo:{symbol:"",chain:"",create_time:""},selectedTimeRange:{start_time:"",end_time:""},indicatorInfo:{required_level:1,handle_name:"",name:"",description:"",doc:"",type:null,param_schema:null},base_params:{},extra_params:{},klineType:"kline",hasLevelAuth:!0,options:null,priceList:[],indicatorDetailList:[],indicatorList:[]},y=Be($e()(Le(s=>({...ce,resetChartPanelData:({refreshChart:a})=>s(r=>{r.base_params={},r.extra_params={},r.klineType="kline",r.indicatorDetailList=null,a&&(r.options=null)}),removeChartStore:()=>s(ce),setDraftData:a=>s(r=>{a(r)})})))),at="_searchWrapper_1j1j5_1",rt="_search_1j1j5_1",ot="_filter_1j1j5_18",it="_category_1j1j5_21",ct="_categoryItem_1j1j5_29",lt="_categoryName_1j1j5_46",dt="_categoryItemSelected_1j1j5_61",ut="_group_1j1j5_72",ht="_groupToCategory_1j1j5_72",mt="_groupToCategoryIcon_1j1j5_83",pt="_groupToCategoryTitle_1j1j5_89",gt="_groupList_1j1j5_95",ft="_result_1j1j5_106",yt="_resultToCategory_1j1j5_106",_t="_resultToCategoryIcon_1j1j5_117",xt="_resultToCategoryTitle_1j1j5_123",jt="_resultIndicatorWrapper_1j1j5_129",vt="_resultIndicatorItem_1j1j5_135",bt="_indicatorItem_1j1j5_138",It="_indicatorItemLevel_1j1j5_152",kt="_indicatorItemLevel0_1j1j5_164",Tt="_indicatorItemLevel1_1j1j5_168",wt="_indicatorItemLevel2_1j1j5_172",Ct="_indicatorName_1j1j5_176",Pt="_indicatorItemActive_1j1j5_180",b={searchWrapper:at,search:rt,filter:ot,category:it,categoryItem:ct,categoryName:lt,categoryItemSelected:dt,group:ut,groupToCategory:ht,groupToCategoryIcon:mt,groupToCategoryTitle:pt,groupList:gt,result:ft,resultToCategory:yt,resultToCategoryIcon:_t,resultToCategoryTitle:xt,resultIndicatorWrapper:jt,resultIndicatorItem:vt,indicatorItem:bt,indicatorItemLevel:It,indicatorItemLevel0:kt,indicatorItemLevel1:Tt,indicatorItemLevel2:wt,indicatorName:Ct,indicatorItemActive:Pt},St=({indicatorList:s,selectCategory:a})=>{const r=y.use.indicatorInfo();return n.jsx("div",{className:b.category,children:(s||[]).map(({category:e,groups:t},o)=>{const i=t.reduce((l,d)=>l+=d.indicators.length,0);return n.jsxs("div",{className:G(b.categoryItem,{[b.categoryItemSelected]:r.category===e}),onClick:()=>a(o),children:[e.length>=15?n.jsx(antd.Tooltip,{title:e,children:n.jsx("span",{className:G(b.categoryName,["common-ellipsis-1"]),children:e})}):e,n.jsx("span",{className:b.indicatorsNum,children:i})]},o)})})},_e=s=>{const{param_schema:a,category:r,handle_name:e,required_level:t,name:o,type:i}=s||{},l=y.use.setDraftData(),d=y.use.indicatorInfo(),m=y.use.resetChartPanelData(),[h,g]=ae(),j=()=>{m({refreshChart:d.category!==r||i!==d.type});const c=new URLSearchParams(h);c.set("handle_name",s.handle_name),g(c),l(p=>{p.indicatorInfo=s}),l(p=>{p.extra_params=pe(a)})};return n.jsxs("div",{className:G(b.indicatorItem,[{[b.indicatorItemActive]:d.handle_name===e}]),onClick:j,children:[n.jsx("span",{className:G(b.indicatorItemLevel,{[b[`indicatorItemLevel${t-1}`]]:!0}),children:`L${t-1}`}),n.jsx("span",{className:b.indicatorName,children:o})]})},xe=({backPreView:s,indicatorList:a=[],selectedCategoryIndex:r,showBack:e=!0})=>{var i;const{items:t,defaultActiveKey:o}=React.useMemo(()=>{var m;const l=(((m=a[r])==null?void 0:m.groups)||[]).filter(h=>{var g;return((g=h.indicators)==null?void 0:g.length)>0}).map((h,g)=>{const j=h.indicators.map((c,p)=>n.jsx(_e,{...c},p));return{key:g,label:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[h.group_name,n.jsx("span",{children:h.indicators.length})]}),children:j}}),d=l.map(h=>h.key);return{items:l,defaultActiveKey:d}},[a,r]);return n.jsxs("div",{className:b.group,children:[e?n.jsxs("div",{className:b.groupToCategory,onClick:s,children:[n.jsx(re,{className:b.groupToCategoryIcon}),n.jsx("span",{className:b.groupToCategoryTitle,children:"All Categories"})]}):null,n.jsx("div",{style:{marginLeft:20},children:(i=a[r])==null?void 0:i.category}),n.jsx("div",{className:b.groupList,children:n.jsx(antd.Collapse,{items:t,defaultActiveKey:o})})]})},je=({backPreView:s,indicatorList:a=[],searchKeyword:r=""})=>{const t=React.useMemo(()=>a.reduce((o,i)=>(o=o.concat(...i.groups.map(l=>l.indicators)),o),[]),[a]).filter(o=>o.name.toLowerCase().includes(r.toLowerCase()));return n.jsxs("div",{className:b.result,children:[n.jsxs("div",{className:b.resultToCategory,onClick:s,children:[n.jsx(re,{className:b.resultToCategoryIcon}),n.jsx("span",{className:b.resultToCategoryTitle,children:"Filtered results"})]}),n.jsx("div",{className:b.resultIndicatorWrapper,children:(t||[]).map((o,i)=>n.jsx("div",{className:b.resultIndicatorItem,children:n.jsx(_e,{...o})},i))})]})};function ve({initStackList:s}){const[a,r]=P(s);return{stackTop:a[a.length-1],stackIn:i=>{r(l=>{l.push(i)})},stackOut:()=>{r(i=>{i.pop()})}}}const Mt=()=>{const s=y.use.indicatorList(),{stackTop:a,stackIn:r,stackOut:e}=ve({initStackList:[0]}),[t,o]=P(""),[i,l]=P(0),d=j=>{o(j.target.value),j.target.value?a!==2&&r(2):e()},m=j=>{l(j),r(1)},h=()=>{e(),o("")},g={0:n.jsx(St,{indicatorList:s,selectCategory:m}),1:n.jsx(xe,{backPreView:e,indicatorList:s,selectedCategoryIndex:i}),2:n.jsx(je,{backPreView:h,indicatorList:s,searchKeyword:t})};return n.jsxs("div",{className:b.search,children:[n.jsx("div",{className:b.filter,children:n.jsx(antd.Input,{placeholder:"Filter Metrics",suffix:Y.filterMetries,allowClear:!0,onChange:d,value:t})}),g[a]]})},At=()=>{const s=y.use.indicatorList(),a=React.useMemo(()=>[{groups:s.reduce((h,g)=>(h.push({group_name:g.category,indicators:g.groups.reduce((j,c)=>j.concat(c.indicators.filter(p=>p.collected)),[])}),h),[])}],[s]),[r,e]=P(""),{stackTop:t,stackIn:o,stackOut:i}=ve({initStackList:[0]}),l=h=>{e(h.target.value),h.target.value?t!==1&&o(1):i()},d=()=>{i(),e("")},m={0:n.jsx(xe,{indicatorList:a,selectedCategoryIndex:0,showBack:!1}),1:n.jsx(je,{backPreView:d,indicatorList:a,searchKeyword:r})};return n.jsxs("div",{className:b.search,children:[n.jsx("div",{className:b.filter,children:n.jsx(antd.Input,{placeholder:"Filter Metrics",suffix:Y.filterMetries,allowClear:!0,onChange:l,value:r})}),m[t]]})};var O=(s=>(s.PRICE_LINE="price_line",s.INDEPENDENT_LINE="independent_line",s.X_BAR="x_bar",s.X_BAR_STACK="x_bar_stack",s.Y_BAR="y_bar",s.Y_BAR_STACK="y_bar_stack",s.AREA_STACK="area_stack",s))(O||{});function Dt(s){return N({url:"/data/api/token/searchToken",method:"GET",params:s})}function Nt(s){return N({url:"/data/api/token/getTokenMarketInfo",method:"GET",params:s})}function oe(s){return N({url:"/data/api/base/indicatorList",method:"GET",params:s})}function Yt(s){return N({url:"/data/api/indicator",method:"POST",params:s})}function be(s){return N({url:"/data/api/base/price",method:"POST",params:s})}function Ot(s){return N({url:"/data/api/userIndicator/collectInd",method:"POST",params:s})}function Bt(s){return N({url:"/data/api/userIndicator/uncollectInd",method:"POST",params:s})}function $t(s){return N({url:"/data/api/userIndicator/saveIndParam",method:"POST",params:s})}const Lt=[{key:"1",label:"All Indicators",children:n.jsx(Mt,{})},{key:"2",label:"My Collected",children:n.jsx(At,{})}],Et=()=>{const s=y.use.setDraftData(),{symbol:a,chain:r}=y.use.tokenInfo();return S(()=>a&&r?oe({symbol:a,chain:r}):null,{onSuccess:e=>{e&&s(t=>{t.indicatorList=e})},refreshDeps:[a,r]}),n.jsx("div",{className:b.searchWrapper,children:n.jsx(antd.Tabs,{type:"line",destroyInactiveTabPane:!0,defaultActiveKey:"1",items:Lt})})},Rt=({options:s})=>{const a=React.useRef(),r=React.useRef();return Fe("resize",()=>{var e;(e=r.current)==null||e.resize()}),React.useEffect(()=>{window.addEventListener("menuChange",()=>{var e;(e=r.current)==null||e.resize()})},[]),React.useEffect(()=>{r.current=echarts.init(a.current)},[]),React.useEffect(()=>{if(!s){r.current.clear();return}console.log("echartsOptions:",s),r.current.setOption(s)},[s]),n.jsx("div",{ref:a,style:{width:"100%",height:"100%"}})};function zt(s){return s.map(a=>[a.open,a.close,a.low,a.high])}const $=(s,a)=>{const r=[...s];for(;r.length<a;)r.unshift(null);return r},L=(s,a)=>{if(s!=null&&s.length)switch(a){case"kline":return{name:"KLine",data:zt(s),type:"candlestick",itemStyle:{color0:"#F63C6B",color:"#0FEDBE",borderColor0:"#F63C6B",borderColor:"#0FEDBE"},yAxisIndex:0,z:0};case"avgPrice":return{name:"Avg Price",data:s.map(r=>r==null?void 0:r.avg_price),type:"line",smooth:!0,yAxisIndex:0,symbol:"none",z:0}}return{}},E=s=>({type:"category",data:s.map(a=>dayjs(a.time).format("YYYY-MM-DD"))}),X=()=>({type:"value",position:"left",axisLabel:{formatter:function(s){return T(s)}},splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.6)",width:.3,type:"solid"}}}),R=s=>{let a=`<strong>Date:</strong> ${s[0].axisValue}<br/>`;return s.forEach(r=>{if(r.seriesType==="candlestick"){const[e,t,o,i,l]=r.value,d=((o-t)/t*100).toFixed(2),m=((l-i)/i*100).toFixed(2);a+=`
              <div style="margin: 5px 0; line-height: 1.5;">
                <strong>${r.seriesName}:</strong> 
                <span style="color: #999;">O:</span> ${T(t)} 
                <span style="color: #999;">C:</span> ${T(o)} 
                <span style="color: #999;">L:</span> ${T(i)} 
                <span style="color: #999;">H:</span> ${T(l)}
              </div>
              <div>
              <div>
              <strong>Change:</strong> 
              <span style="color: ${d>=0?"green":"red"};">${d}%</span>
              </div>
              <div>
              <strong>Amplitude:</strong>
              <span">${m}%</span>
              </div>
              </div>
            `}else r.axisType==="yAxis.category"?a+=`
                <div>
                  <strong>${r.seriesName}:</strong> ${T(r.value)}
                </div>
          `:r.axisType==="xAxis.value"||(a+=`
                <div >
                <strong>${r.seriesName}:</strong> ${T(r.value)}
                </div>
          `)}),a},z={dataZoom:[{type:"slider",xAxisIndex:0,filterMode:"filter",backgroundColor:"#2d4137",borderColor:"transparent"},{type:"inside",xAxisIndex:0,filterMode:"filter"}],grid:{top:"10%",left:"2%",right:"2%",bottom:"12%",containLabel:!0},legend:{},graphic:[{type:"text",left:"center",top:"center",style:{text:"tokenalytic.com",fontSize:60,fill:"rgba(100, 100, 0, 0.3)",textAlign:"center"}}],legend:{textStyle:{color:"#ccc"}}},Ie=(s,a)=>{const r=a.reduce((h,g)=>g.low<h?g.low:h,a[0].low),e=a.reduce((h,g)=>g.high>h?g.high:h,a[0].high);let t=[...s];const o=s[0].price_range_upper-s[0].price_range_lower;if(o===0)return t=[],{newIndicatorData:t,klineMinPrice:r,klineMaxPrice:e};const i=s.reduce((h,g)=>g.price_range_upper>h?g.price_range_upper:h,s[0].price_range_upper),l=s.reduce((h,g)=>g.price_range_lower<h?g.price_range_lower:h,s[0].price_range_lower),d=Math.floor((l-r)/o),m=Math.ceil((e-i)/o);console.log("step",o),console.log("klineMinPrice",r,"klineMaxPrice",e),console.log("minPrice",l,"maxPrice",i),console.log("toFixedStepsLower",d),console.log("toFixedStepsUpper",m);for(let h=0;h<d;h++)t.unshift({price_range_lower:l-o*(h+1),price_range_upper:l-o*h,positive_value:0,negative_value:0});for(let h=0;h<m;h++)t.push({price_range_lower:i+o*h,price_range_upper:i+o*(h+1),positive_value:0,negative_value:0});return{newIndicatorData:t,klineMinPrice:r,klineMaxPrice:e}};function Ft({indicatorDetailList:s,priceList:a,klineType:r}){s=$(s,a.length);const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:[E(a)],yAxis:[{type:"value",name:"price($)",splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.6)",width:.3,type:"solid"}}}],series:[]};if(a!=null&&a.length){const t=L(a,r);e.series.push(t)}return s!=null&&s.length&&e.series.push({name:"Indicator",data:s.map(t=>t==null?void 0:t.value),type:"line",areaStyle:{color:"rgba(0, 123, 255, 0.2)"},smooth:!0,symbol:"none"}),e}function le({indicatorDetailList:s,priceList:a,klineType:r}){s=$(s,a.length);const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:a!=null&&a.length?[E(a)]:[],yAxis:[],series:[]};if(a!=null&&a.length){e.yAxis.push({type:"value",name:"price($)",position:"right",splitLine:{show:!1}});const t=L(a,r);e.series.push(t)}return s!=null&&s.length&&(e.yAxis.push(X()),e.series.push({name:"Indicator",data:s.map(t=>t==null?void 0:t.value),type:"line",smooth:!0,symbol:"none",yAxisIndex:1})),e}function Wt({indicatorDetailList:s,priceList:a,klineType:r}){s=$(s,a.length);const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:E(a),yAxis:[],series:[]};if(a!=null&&a.length){e.yAxis.push({type:"value",name:"price",position:"right",splitLine:{show:!1}});const t=L(a,r);e.series.push(t)}return s!=null&&s.length&&(e.yAxis.push(X()),e.series.push({name:"Indicator",data:s.map(t=>t==null?void 0:t.value),type:"bar",yAxisIndex:1,barCategoryGap:"60%",itemStyle:{color:t=>t.value<0?"rgba(255, 127, 80, 0.8)":"rgba(30, 214, 255, 0.8)"}})),e}function Ut({indicatorDetailList:s,priceList:a,klineType:r}){s=$(s,a.length);const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:E(a),yAxis:[],series:[]};if(a!=null&&a.length){e.yAxis.push({type:"value",name:"price",position:"right",splitLine:{show:!1}});const t=L(a,r);e.series.push(t)}return s!=null&&s.length&&(e.yAxis.push(X()),e.series.push({name:"Positive Value",data:s.map(t=>t==null?void 0:t.positive_value),type:"bar",stack:"x-bar-stack",itemStyle:{color:"rgba(30, 214, 255, 0.5)"},tooltip:{valueFormatter:t=>T(t)},yAxisIndex:1,barCategoryGap:"60%"}),e.series.push({name:"Negative Value",data:s.map(t=>t==null?void 0:t.negative_value),type:"bar",stack:"x-bar-stack",itemStyle:{color:" rgba(255, 127, 80, 0.5)"},tooltip:{valueFormatter:t=>T(t)},yAxisIndex:1})),e}function Ht({indicatorDetailList:s,priceList:a,klineType:r}){const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:[E(s)],yAxis:[],series:[]};if(a!=null&&a.length){e.yAxis.push({type:"value",name:"price",splitLine:{show:!1},position:"right",nameLocation:"middle"});const t=L(a,r);e.series.push(t)}if(s!=null&&s.length){const{newIndicatorData:t,klineMinPrice:o,klineMaxPrice:i}=Ie(s,a);e.yAxis[0].min=o,e.yAxis[0].max=i,e.xAxis.push({type:"value",name:"Volume",nameLocation:"middle",splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.4)",width:.5,type:"solid"}}}),e.yAxis.push({type:"category",data:t.map(l=>l.price_range_lower),name:"Price Levels",nameLocation:"middle",position:"left",axisLabel:{formatter:function(l){return T(l)}}}),e.series.push({name:"Indicator",type:"bar",data:t.map(l=>l.total_Value),barWidth:"40%",itemStyle:{color:l=>l.value<0?"rgba(255, 127, 80, 0.4)":"rgba(30, 214, 255, 0.4)"}}),e.series[e.series.length-1].xAxisIndex=e.series.length-1,e.series[e.series.length-1].yAxisIndex=e.series.length-1}return e}function Gt({indicatorDetailList:s,priceList:a,klineType:r}){const e={...z,tooltip:{trigger:"axis",formatter:function(t){return R(t)}},xAxis:[E(a)],yAxis:[],series:[]};if(a!=null&&a.length&&(e.yAxis.push({type:"value",name:"price",nameLocation:"middle",splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.4)",width:.5,type:"solid"}},position:"right"}),e.series.push(L(a,r))),s!=null&&s.length){const{newIndicatorData:t,klineMinPrice:o,klineMaxPrice:i}=Ie(s,a);e.yAxis[0].min=T(o),e.yAxis[0].max=T(i),e.xAxis.push({type:"value",name:"Volume",nameLocation:"middle",splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.4)",width:.5,type:"solid"}},axisLabel:{formatter:function(l){return T(l)}}}),e.yAxis.push({type:"category",data:t.map(l=>l.price_range_lower),name:"Price Levels",nameLocation:"middle",position:"left",axisLabel:{formatter:function(l){return T(l)}}}),e.series.push({name:"Positive Value",data:t.map(l=>l.positive_value),type:"bar",stack:"y-bar-stack",itemStyle:{color:"rgba(30, 214, 255, 0.5)"},yAxisIndex:1,xAxisIndex:1}),e.series.push({name:"Negative Value",data:t.map(l=>l.negative_value),type:"bar",stack:"y-bar-stack",itemStyle:{color:"rgba(255, 127, 80, 0.5)"},yAxisIndex:1,xAxisIndex:1})}return e}function Vt({indicatorDetailList:s,priceList:a,klineType:r}){const e=$(s[0],a.length),t=$(s[1],a.length),o={...z,tooltip:{trigger:"axis",formatter:function(i){return R(i)}},xAxis:[E(a)],yAxis:[],series:[]};if(a!=null&&a.length){o.yAxis.push({type:"value",name:"price($)",position:"right",splitLine:{show:!1}});const i=L(a,r);o.series.push(i)}return s!=null&&s.length&&(o.yAxis.push(X()),o.series.push({name:"indicator",data:e.map(i=>i==null?void 0:i.value),type:"line",areaStyle:{color:"rgba(100, 23, 25, 0.2)"},smooth:!0,symbol:"none",yAxisIndex:1}),o.series.push({name:"indicator",data:t.map(i=>i==null?void 0:i.value),type:"line",areaStyle:{color:"rgba(0, 123, 255, 0.2)"},smooth:!0,symbol:"none",yAxisIndex:1})),o}function qt({type:s,indicatorDetailList:a=[],priceList:r=[],klineType:e=""}){switch(s){case O.PRICE_LINE:return Ft({indicatorDetailList:a,priceList:r,klineType:e});case O.INDEPENDENT_LINE:return le({indicatorDetailList:a,priceList:r,klineType:e});case O.X_BAR:return Wt({indicatorDetailList:a,priceList:r,klineType:e});case O.X_BAR_STACK:return Ut({indicatorDetailList:a,priceList:r,klineType:e});case O.Y_BAR:return Ht({indicatorDetailList:a,priceList:r,klineType:e});case O.Y_BAR_STACK:return Gt({indicatorDetailList:a,priceList:r,klineType:e});case O.AREA_STACK:return Vt({indicatorDetailList:a,priceList:r,klineType:e});default:return le({indicatorDetailList:a,priceList:r,klineType:e})}}const Kt="_dataPanel_hg95k_1",Xt="_maskBackground_hg95k_7",Jt="_echartsPanel_hg95k_14",Zt="_setting_hg95k_14",Qt="_settingTitle_hg95k_20",es="_baseSettingTitle_hg95k_29",ts="_echartsWrapper_hg95k_38",ne={dataPanel:Kt,maskBackground:Xt,echartsPanel:Jt,setting:Zt,settingTitle:Qt,baseSettingTitle:es,echartsWrapper:ts},ss=()=>{var s=new Date,a=new Date(s.getFullYear()-1,s.getMonth(),s.getDate());return a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0")+"-"+String(a.getDate()).padStart(2,"0")},K=()=>{var s=new Date,a=new Date(s.getFullYear(),s.getMonth()-3,s.getDate());return a.getFullYear()+"-"+String(a.getMonth()+1).padStart(2,"0")+"-"+String(a.getDate()).padStart(2,"0")},ns=s=>{var a=new Date,r=new Date(a.getTime()-s*24*60*60*1e3);return r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")},as=()=>{const{symbol:s,chain:a}=y.use.tokenInfo(),{start_time:r,end_time:e}=y.use.selectedTimeRange(),{handle_name:t,type:o}=y.use.indicatorInfo(),i=y.use.indicatorDetailList(),l=y.use.priceList(),d=y.use.klineType(),m=y.use.base_params(),h=y.use.extra_params(),g=y.use.options(),j=y.use.setDraftData(),{loading:c,error:p,run:v}=S(()=>{if(!s||!a||!t)return[];var C;return r?C=r:C=K(),Yt({symbol:s,chain:a,start_time:C,end_time:e,handle_name:t,base_params:m,extra_params:h})},{refreshDeps:[s,a,r,e,t,m,h],onSuccess:C=>{j(M=>{M.indicatorDetailList=C})}}),{loading:u,error:x,run:I}=S(()=>{if(!s||!a)return[];var C;return r?C=r:C=K(),be({symbol:s,chain:a,start_time:C,end_time:e})},{refreshDeps:[s,a,r,e],onSuccess:C=>{j(M=>{M.priceList=C})}});React.useEffect(()=>{Array.isArray(i)&&(l!=null&&l.length)&&d&&o&&j(C=>{C.options=qt({type:o,indicatorDetailList:i,priceList:l,klineType:d})})},[i,l,d,o]);const w=()=>p||x?n.jsx(We,{style:{color:"gray"},onClick:()=>{v(),I()}}):n.jsxs(n.Fragment,{children:[c||u?n.jsx(Ue,{style:{fontSize:20,position:"absolute"}}):null,n.jsx(Rt,{options:g})]});return n.jsx("div",{className:ne.echartsWrapper,children:w()})},rs="_maskGuide_q1h56_1",os="_content_q1h56_15",is="_upgradeBtn_q1h56_20",cs="_upgradeBtnText_q1h56_23",U={maskGuide:rs,content:os,upgradeBtn:is,upgradeBtnText:cs},ls=()=>{const s=V(),a=()=>{window.location.href="/sign-in"},r=()=>{window.location.href="/sign-up"},e=()=>{window.location.href="/pricing"};return n.jsx("div",{className:U.maskGuide,children:n.jsxs("div",{className:U.content,children:[Y.lock,n.jsx(antd.Typography.Title,{level:4,children:"Unlock Full Access"}),n.jsx(antd.Typography.Paragraph,{children:"Upgrade your plan to view the chart"}),n.jsx("div",{children:!s||!s.level?n.jsxs("div",{style:{display:"flex",gap:"12px"},children:[n.jsx(antd.Button,{className:U.upgradeBtn,onClick:r,children:" sign-up"}),n.jsx(antd.Button,{className:U.upgradeBtn,type:"primary",onClick:a,children:" sign-in"})]}):n.jsx("div",{children:n.jsx(antd.Button,{className:U.upgradeBtn,type:"primary",onClick:e,children:n.jsx("span",{className:U.upgradeBtnText,children:"Upgrade Now"})})})})]})})},ds="_topInfo_v1ljm_1",us="_info_v1ljm_10",hs="_indicatorItemLevel_v1ljm_14",ms="_indicatorItemLevel0_v1ljm_26",ps="_indicatorItemLevel1_v1ljm_30",gs="_indicatorItemLevel2_v1ljm_34",fs="_title_v1ljm_38",q={topInfo:ds,info:us,indicatorItemLevel:hs,indicatorItemLevel0:ms,indicatorItemLevel1:ps,indicatorItemLevel2:gs,title:fs},ys=()=>{const{symbol:s,chain:a}=y.use.tokenInfo(),{handle_name:r,collected:e}=y.use.indicatorInfo(),t=y.use.base_params(),o=y.use.extra_params(),i=y.use.setDraftData(),{run:l}=S(oe,{manual:!0,onSuccess:c=>{i(p=>{p.indicatorList=c})}}),{runAsync:d,loading:m}=S(Ot,{manual:!0,onSuccess:()=>{i(c=>{c.indicatorInfo.collected=!0}),l({symbol:s,chain:a})},onError:c=>{console.error("Failed to toggle collection status:",c)},refreshDeps:[s,a]}),{runAsync:h,loading:g}=S(Bt,{manual:!0,onSuccess:()=>{i(c=>{c.indicatorInfo.collected=!1}),l({symbol:s,chain:a})},onError:c=>{console.error("Failed to toggle collection status:",c)},refreshDeps:[s,a]}),j=()=>{const c={handle_name:r,base_params:JSON.stringify(t),extra_params:JSON.stringify(o)};e?h(c):d(c)};return n.jsx("div",{onClick:j,style:{cursor:m||g?"wait":"pointer",padding:"8px"},children:e?n.jsx(He,{style:{color:"#fadb14",opacity:m||g?.5:1}}):n.jsx(Ge,{style:{opacity:m||g?.5:1}})})},_s=()=>{const s=y.use.indicatorInfo(),a=r=>{const e=r.split(" "),o=e.length>10?`${e.slice(0,10).join(" ")}...`:r;return n.jsx(antd.Tooltip,{title:r,children:n.jsx("span",{style:{color:"gray"},children:o})})};return n.jsxs("div",{className:q.topInfo,children:[n.jsxs("div",{className:q.info,children:[n.jsx("span",{className:G(q.indicatorItemLevel,{[q[`indicatorItemLevel${s.required_level-1}`]]:!0}),children:`L${s.required_level-1}`}),n.jsx("span",{className:q.title,children:s.name}),n.jsxs("div",{children:[a(s.description),s.doc&&n.jsx("a",{href:s.doc,target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"8px",color:"green",borderBottom:"1px solid green"},children:"LearnMore"})]})]}),n.jsx("div",{children:n.jsx(ys,{})})]})},xs="_componentWrapper_1nvt9_1",js="_setting_1nvt9_4",vs="_baseSetting_1nvt9_8",bs="_title_1nvt9_12",Is="_checkboxGrop_1nvt9_28",ks="_saveParam_1nvt9_36",H={componentWrapper:xs,setting:js,baseSetting:vs,title:bs,checkboxGrop:Is,saveParam:ks};var ke={exports:{}};(function(s,a){(function(r,e){s.exports=e()})(fe,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(e,t,o){var i=t.prototype,l=i.format;o.en.formats=r,i.format=function(d){d===void 0&&(d="YYYY-MM-DDTHH:mm:ssZ");var m=this.$locale().formats,h=function(g,j){return g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(c,p,v){var u=v&&v.toUpperCase();return p||j[v]||r[v]||j[u].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(x,I,w){return I||w.slice(1)})})}(d,m===void 0?{}:m);return l.call(this,h)}}})})(ke);var Ts=ke.exports;const ws=ye(Ts);var Te={exports:{}};(function(s,a){(function(r,e){s.exports=e()})(fe,function(){return function(r,e,t){e.prototype.isBetween=function(o,i,l,d){var m=t(o),h=t(i),g=(d=d||"()")[0]==="(",j=d[1]===")";return(g?this.isAfter(m,l):!this.isBefore(m,l))&&(j?this.isBefore(h,l):!this.isAfter(h,l))||(g?this.isBefore(m,l):!this.isAfter(m,l))&&(j?this.isAfter(h,l):!this.isBefore(h,l))}}})})(Te);var Cs=Te.exports;const Ps=ye(Cs);dayjs.extend(ws);dayjs.extend(Qe);dayjs.extend(Ps);dayjs.extend(et);const Ss={YY:"year",YYYY:{sectionType:"year",contentType:"digit",maxLength:4},M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMM:{sectionType:"month",contentType:"letter"},MMMM:{sectionType:"month",contentType:"letter"},D:{sectionType:"day",contentType:"digit",maxLength:2},DD:"day",Do:{sectionType:"day",contentType:"digit-with-letter"},d:{sectionType:"weekDay",contentType:"digit",maxLength:2},dd:{sectionType:"weekDay",contentType:"letter"},ddd:{sectionType:"weekDay",contentType:"letter"},dddd:{sectionType:"weekDay",contentType:"letter"},A:"meridiem",a:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},Ms={year:"YYYY",month:"MMMM",monthShort:"MMM",dayOfMonth:"D",dayOfMonthFull:"Do",weekday:"dddd",weekdayShort:"dd",hours24h:"HH",hours12h:"hh",meridiem:"A",minutes:"mm",seconds:"ss",fullDate:"ll",keyboardDate:"L",shortDate:"MMM D",normalDate:"D MMMM",normalDateWithWeekday:"ddd, MMM D",fullTime:"LT",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",keyboardDateTime:"L LT",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"},Q=["Missing UTC plugin","To be able to use UTC or timezones, you have to enable the `utc` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-utc"].join(`
`),de=["Missing timezone plugin","To be able to use timezones, you have to enable both the `utc` and the `timezone` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-timezone"].join(`
`),As=(s,a)=>a?(...r)=>s(...r).locale(a):s;class Ds{constructor({locale:a,formats:r}={}){this.isMUIAdapter=!0,this.isTimezoneCompatible=!0,this.lib="dayjs",this.dayjs=void 0,this.locale=void 0,this.formats=void 0,this.escapedCharacters={start:"[",end:"]"},this.formatTokenMap=Ss,this.setLocaleToValue=e=>{const t=this.getCurrentLocaleCode();return t===e.locale()?e:e.locale(t)},this.hasUTCPlugin=()=>typeof dayjs.utc<"u",this.hasTimezonePlugin=()=>typeof dayjs.tz<"u",this.isSame=(e,t,o)=>{const i=this.setTimezone(t,this.getTimezone(e));return e.format(o)===i.format(o)},this.cleanTimezone=e=>{switch(e){case"default":return;case"system":return dayjs.tz.guess();default:return e}},this.createSystemDate=e=>{if(this.hasUTCPlugin()&&this.hasTimezonePlugin()){const t=dayjs.tz.guess();return t!=="UTC"?dayjs.tz(e,t):dayjs(e)}return dayjs(e)},this.createUTCDate=e=>{if(!this.hasUTCPlugin())throw new Error(Q);return dayjs.utc(e)},this.createTZDate=(e,t)=>{if(!this.hasUTCPlugin())throw new Error(Q);if(!this.hasTimezonePlugin())throw new Error(de);const o=e!==void 0&&!e.endsWith("Z");return dayjs(e).tz(this.cleanTimezone(t),o)},this.getLocaleFormats=()=>{const e=dayjs.Ls,t=this.locale||"en";let o=e[t];return o===void 0&&(o=e.en),o.formats},this.adjustOffset=e=>{if(!this.hasTimezonePlugin())return e;const t=this.getTimezone(e);if(t!=="UTC"){const o=e.tz(this.cleanTimezone(t),!0);if(o.$offset===(e.$offset??0))return e;e.$offset=o.$offset}return e},this.date=(e,t="default")=>{if(e===null)return null;let o;return t==="UTC"?o=this.createUTCDate(e):t==="system"||t==="default"&&!this.hasTimezonePlugin()?o=this.createSystemDate(e):o=this.createTZDate(e,t),this.locale===void 0?o:o.locale(this.locale)},this.getInvalidDate=()=>dayjs(new Date("Invalid date")),this.getTimezone=e=>{var t;if(this.hasTimezonePlugin()){const o=(t=e.$x)==null?void 0:t.$timezone;if(o)return o}return this.hasUTCPlugin()&&e.isUTC()?"UTC":"system"},this.setTimezone=(e,t)=>{if(this.getTimezone(e)===t)return e;if(t==="UTC"){if(!this.hasUTCPlugin())throw new Error(Q);return e.utc()}if(t==="system")return e.local();if(!this.hasTimezonePlugin()){if(t==="default")return e;throw new Error(de)}return dayjs.tz(e,this.cleanTimezone(t))},this.toJsDate=e=>e.toDate(),this.parse=(e,t)=>e===""?null:this.dayjs(e,t,this.locale,!0),this.getCurrentLocaleCode=()=>this.locale||"en",this.is12HourCycleInCurrentLocale=()=>/A|a/.test(this.getLocaleFormats().LT||""),this.expandFormat=e=>{const t=this.getLocaleFormats(),o=i=>i.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(l,d,m)=>d||m.slice(1));return e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(i,l,d)=>{const m=d&&d.toUpperCase();return l||t[d]||o(t[m])})},this.isValid=e=>e==null?!1:e.isValid(),this.format=(e,t)=>this.formatByString(e,this.formats[t]),this.formatByString=(e,t)=>this.dayjs(e).format(t),this.formatNumber=e=>e,this.isEqual=(e,t)=>e===null&&t===null?!0:e===null||t===null?!1:e.toDate().getTime()===t.toDate().getTime(),this.isSameYear=(e,t)=>this.isSame(e,t,"YYYY"),this.isSameMonth=(e,t)=>this.isSame(e,t,"YYYY-MM"),this.isSameDay=(e,t)=>this.isSame(e,t,"YYYY-MM-DD"),this.isSameHour=(e,t)=>e.isSame(t,"hour"),this.isAfter=(e,t)=>e>t,this.isAfterYear=(e,t)=>this.hasUTCPlugin()?!this.isSameYear(e,t)&&e.utc()>t.utc():e.isAfter(t,"year"),this.isAfterDay=(e,t)=>this.hasUTCPlugin()?!this.isSameDay(e,t)&&e.utc()>t.utc():e.isAfter(t,"day"),this.isBefore=(e,t)=>e<t,this.isBeforeYear=(e,t)=>this.hasUTCPlugin()?!this.isSameYear(e,t)&&e.utc()<t.utc():e.isBefore(t,"year"),this.isBeforeDay=(e,t)=>this.hasUTCPlugin()?!this.isSameDay(e,t)&&e.utc()<t.utc():e.isBefore(t,"day"),this.isWithinRange=(e,[t,o])=>e>=t&&e<=o,this.startOfYear=e=>this.adjustOffset(e.startOf("year")),this.startOfMonth=e=>this.adjustOffset(e.startOf("month")),this.startOfWeek=e=>this.adjustOffset(this.setLocaleToValue(e).startOf("week")),this.startOfDay=e=>this.adjustOffset(e.startOf("day")),this.endOfYear=e=>this.adjustOffset(e.endOf("year")),this.endOfMonth=e=>this.adjustOffset(e.endOf("month")),this.endOfWeek=e=>this.adjustOffset(this.setLocaleToValue(e).endOf("week")),this.endOfDay=e=>this.adjustOffset(e.endOf("day")),this.addYears=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"year"):e.add(t,"year")),this.addMonths=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"month"):e.add(t,"month")),this.addWeeks=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"week"):e.add(t,"week")),this.addDays=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"day"):e.add(t,"day")),this.addHours=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"hour"):e.add(t,"hour")),this.addMinutes=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"minute"):e.add(t,"minute")),this.addSeconds=(e,t)=>this.adjustOffset(t<0?e.subtract(Math.abs(t),"second"):e.add(t,"second")),this.getYear=e=>e.year(),this.getMonth=e=>e.month(),this.getDate=e=>e.date(),this.getHours=e=>e.hour(),this.getMinutes=e=>e.minute(),this.getSeconds=e=>e.second(),this.getMilliseconds=e=>e.millisecond(),this.setYear=(e,t)=>this.adjustOffset(e.set("year",t)),this.setMonth=(e,t)=>this.adjustOffset(e.set("month",t)),this.setDate=(e,t)=>this.adjustOffset(e.set("date",t)),this.setHours=(e,t)=>this.adjustOffset(e.set("hour",t)),this.setMinutes=(e,t)=>this.adjustOffset(e.set("minute",t)),this.setSeconds=(e,t)=>this.adjustOffset(e.set("second",t)),this.setMilliseconds=(e,t)=>this.adjustOffset(e.set("millisecond",t)),this.getDaysInMonth=e=>e.daysInMonth(),this.getWeekArray=e=>{const t=this.startOfWeek(this.startOfMonth(e)),o=this.endOfWeek(this.endOfMonth(e));let i=0,l=t;const d=[];for(;l<o;){const m=Math.floor(i/7);d[m]=d[m]||[],d[m].push(l),l=this.addDays(l,1),i+=1}return d},this.getWeekNumber=e=>e.week(),this.getYearRange=([e,t])=>{const o=this.startOfYear(e),i=this.endOfYear(t),l=[];let d=o;for(;this.isBefore(d,i);)l.push(d),d=this.addYears(d,1);return l},this.dayjs=As(dayjs,a),this.locale=a,this.formats=Ve({},Ms,r),dayjs.extend(tt)}getDayOfWeek(a){return a.day()+1}}const Ns=De({palette:{mode:"dark",primary:{main:"rgba(255, 255, 255, 0.65)"},secondary:{main:"#7451ff",light:"#8f73ff"},error:{main:"#EF8F8F"},background:{default:"#121212",paper:"#1E1E1E"}},spacing:0}),Ys=s=>n.jsx(Ne,{theme:Ns,children:n.jsx(Ye,{dateAdapter:Ds,children:s.children})}),Os="_home_iuwsz_1",Bs="_customDatePicker_iuwsz_9",$s={home:Os,customDatePicker:Bs},Ls=s=>{const{title:a,value:r,tooltip:e,onChange:t}=s,o=i=>{if(i){const l=dayjs(i).format("YYYY-MM-DD");console.log("formatTime on change",l),t(l)}};return n.jsx(Ys,{children:n.jsxs("div",{style:{marginTop:5,display:"flex"},children:[e&&n.jsx(antd.Tooltip,{title:e,children:n.jsx(qe,{})}),n.jsx("div",{className:$s.customDatePicker,children:n.jsx(Oe,{label:a,value:dayjs(r),onChange:o,slotProps:{popper:{sx:{"& .MuiDateCalendar-root":{zoom:.8}}}},sx:{"& .MuiOutlinedInput-input":{padding:"8px 14px"}}})})]})})},Es=[{label:"DEX",value:"DEX"},{label:"CEX",value:"CEX"},{label:"MEV Bot",value:"MEV Bot"},{label:"Contract",value:"Contract"},{label:"Staker",value:"Staker"}],Rs=()=>{var u;const s=y.use.setDraftData(),a=V(),r=y.use.base_params(),e=y.use.extra_params(),t=y.use.tokenInfo(),{param_schema:o,handle_name:i}=y.use.indicatorInfo(),{use_base_param:l,extra_params_schema:d}=JSON.parse(o||null)||{};d&&(d.displayType="inline");const m=st();React.useEffect(()=>{m.resetFields()},[i]);const h=x=>{s(I=>{I.base_params={exclude_wallets:{by_labels:x}}})},g=x=>{s(I=>{I.extra_params=x})},{run:j}=S(oe,{manual:!0,onSuccess:x=>{s(I=>{I.indicatorList=x})}}),{runAsync:c,loading:p}=S(()=>$t({handle_name:i,symbol:t.symbol,chain:t.chain,base_params:JSON.stringify(r),extra_params:JSON.stringify(e)}),{manual:!0,onSuccess:()=>{j({symbol:t.symbol,chain:t.chain})}});function v(){return(a==null?void 0:a.level)>=3}return n.jsxs("div",{className:H.setting,children:[l?n.jsx(antd.Popover,{placement:"bottomLeft",content:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n.jsx("h3",{style:{padding:0,margin:0},children:"Recalculate the indicator after filtering specific wallets"}),n.jsx(antd.Divider,{style:{padding:0,margin:0}}),n.jsx(antd.Checkbox.Group,{options:Es.map(x=>({...x,disabled:!v()})),value:((u=r==null?void 0:r.exclude_wallets)==null?void 0:u.by_labels)||[],onChange:h,className:H.checkboxGrop}),!v()&&n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},children:[n.jsx("span",{style:{color:"gray"},children:"This feature requires Advanced plan"}),n.jsx(antd.Button,{type:"primary",size:"small",onClick:()=>window.location.href="/pricing",children:"Upgrade Now"})]})]}),getPopupContainer:x=>x.parentNode,children:n.jsxs("span",{className:H.baseSetting,children:[n.jsx("span",{className:H.title,children:"Label Filter"}),n.jsx("span",{children:"DEX / CEX / MEV Bot"}),Y.downOutlined]})}):null,d?n.jsxs("div",{style:{alignItems:"center",display:"flex"},children:[n.jsx(nt,{form:m,schema:d,widgets:{CustomDatePicker:Ls},watch:{"#":x=>{g(x)}},style:{marginLeft:24}}),n.jsx(antd.Button,{className:H.saveParam,onClick:c,loading:p,size:"small",children:"save"})]}):null]})},zs=()=>n.jsx("div",{className:H.componentWrapper,children:n.jsx(Rs,{})}),Fs="_componentWrapper_1kdnt_1",Ws="_calendarContainer_1kdnt_8",Us="_calendarOptions_1kdnt_17",Hs="_calendarOption_1kdnt_17",Gs="_active_1kdnt_35",Vs="_calendarPicker_1kdnt_40",qs="_iconContainer_1kdnt_58",Ks="_selected_1kdnt_76",B={componentWrapper:Fs,calendarContainer:Ws,calendarOptions:Us,calendarOption:Hs,active:Gs,calendarPicker:Vs,"ant-picker-input":"_ant-picker-input_1kdnt_51","ant-picker-suffix":"_ant-picker-suffix_1kdnt_54",iconContainer:qs,selected:Ks},{RangePicker:Xs}=antd.DatePicker,Js=()=>{const[s,a]=P(!1),[r,e]=P("3M"),t=y.use.tokenInfo(),o=y.use.setDraftData(),i=V(),[l,d]=P(!1),[m,h]=P("upgrade"),g=v=>{a(v)},j=(v,u)=>{if(v&&u[0]&&u[1]){const x=dayjs(u[0]).format("YYYY-MM-DD HH:mm:ss"),I=dayjs(u[1]).format("YYYY-MM-DD HH:mm:ss");o(w=>{w.selectedTimeRange.start_time=x,w.selectedTimeRange.end_time=I}),e("")}},c=v=>{let u="",x=dayjs().format("YYYY-MM-DD HH:mm:ss");switch(v){case"1M":u=dayjs().subtract(1,"month").format("YYYY-MM-DD 00:00:00");break;case"3M":u=dayjs().subtract(3,"month").format("YYYY-MM-DD 00:00:00");break;case"1Y":if(!i.uid){h("login"),d(!0);return}if(!i.level||i.level<2){h("upgrade"),d(!0);return}u=dayjs().subtract(1,"year").format("YYYY-MM-DD 00:00:00");break;case"YTD":u=dayjs().startOf("year").format("YYYY-MM-DD 00:00:00");break;case"All":if(!i.uid){h("login"),d(!0);return}if(!i.level||i.level<3){h("upgrade"),d(!0);return}u=t.create_time;break;default:u=dayjs().subtract(3,"month").format("YYYY-MM-DD 00:00:00");break}o(I=>{I.selectedTimeRange.start_time=u,I.selectedTimeRange.end_time=x}),e(v)},p=n.jsx("div",{className:B.datePickerContainer,children:n.jsx(Xs,{onChange:j})});return n.jsxs("div",{className:B.calendarContainer,children:[n.jsxs("div",{className:B.calendarOptions,children:[["1M","3M","1Y","YTD","All"].map(v=>n.jsx("span",{className:`${B.calendarOption} ${r===v?B.selected:""}`,onClick:()=>c(v),children:v},v)),n.jsx(antd.Dropdown,{overlay:p,trigger:["click"],open:s,onOpenChange:g,children:n.jsx(antd.Button,{icon:n.jsx(Ke,{}),className:B.calendarIcon,type:"text"})})]}),n.jsx(Ee,{type:m,visible:l,onClose:()=>d(!1)})]})},Zs=()=>{const s=y.use.klineType(),a=y.use.setDraftData(),r=()=>{a(e=>{e.klineType=s==="kline"?"avgPrice":"kline"})};return n.jsx("div",{onClick:r,className:B.iconContainer,children:s==="kline"?Y.switch:Y.kine})},Qs=()=>n.jsxs("div",{className:B.componentWrapper,children:[n.jsx(Js,{}),n.jsx(Zs,{})]}),en="_chartSetting_1fkk0_1",tn={chartSetting:en},sn=()=>n.jsxs("div",{className:tn.chartSetting,children:[n.jsx(zs,{}),n.jsx(Qs,{})]}),nn=()=>{const s=V(),a=y.use.indicatorInfo(),r=n.jsxs("div",{children:[n.jsx(sn,{}),n.jsx(as,{})]}),e=n.jsx(n.Fragment,{children:n.jsx(ls,{})});return n.jsx("div",{className:ne.dataPanel,children:n.jsxs("div",{className:ne.echartsPanel,children:[n.jsx(_s,{}),a.required_level<=1?r:!s.level||s.level<a.required_level?e:r]})})},an="_charts_atg58_1",rn="_top_atg58_7",on="_content_atg58_10",ue={charts:an,top:rn,content:on},cn=()=>{const s=y.use.removeChartStore();return React.useEffect(()=>()=>{s()},[s]),n.jsx("div",{className:ue.charts,children:n.jsxs("div",{className:ue.content,children:[n.jsx(Et,{}),n.jsx(antd.Divider,{type:"vertical",style:{height:"100vh",margin:0}}),n.jsx(nn,{})]})})},{Text:ln}=antd.Typography,dn={ethereum:Y.ethLogo,base:Y.baseLogo},he=({suffixCount:s=12,children:a,className:r,title:e,chain:t})=>{const o=a==null?void 0:a.slice(0,(a==null?void 0:a.length)-s),i=a==null?void 0:a.slice(-s).trim();return n.jsxs("div",{style:{display:"flex",marginLeft:"6px",alignItems:"center"},children:[t&&dn[t],n.jsx(ln,{title:e,className:r,style:{maxWidth:"100%"},ellipsis:{suffix:i},children:o})]})},un="_header_p50pr_1",hn="_leftWrapper_p50pr_7",mn="_title_p50pr_10",pn="_left_p50pr_7",gn="_skeleton_p50pr_28",fn="_leftTop_p50pr_32",yn="_logo_p50pr_36",_n="_name_p50pr_40",xn="_arrow_p50pr_48",jn="_leftBottom_p50pr_51",vn="_right_p50pr_54",bn="_itemInfo_p50pr_60",In="_valueInfo_p50pr_80",kn="_tokenContent_p50pr_94",Tn="_content_p50pr_100",wn="_item_p50pr_60",Cn="_itemHeader_p50pr_125",Pn="_itemHeaderName_p50pr_128",Sn="_itemHeaderDesc_p50pr_134",Mn="_rightBottom_p50pr_150",An="_contract_address_p50pr_155",Dn="_chainTabs_p50pr_164",k={header:un,leftWrapper:hn,title:mn,left:pn,skeleton:gn,leftTop:fn,logo:yn,name:_n,arrow:xn,leftBottom:jn,right:vn,itemInfo:bn,valueInfo:In,tokenContent:kn,content:Tn,item:wn,itemHeader:Cn,itemHeaderName:Pn,itemHeaderDesc:Sn,rightBottom:Mn,contract_address:An,chainTabs:Dn},Nn=[{key:"ethereum",label:"Ethereum"},{key:"base",label:"Base"}],Yn=()=>{const s=new URLSearchParams(location.search),a=s.get("chain"),r=s.get("symbol"),e=s.get("handle_name"),t=!!(a&&r&&e),[o,i]=ae(),l=React.useRef({resetFlag:t}),[d,m]=P(!1),[h,g]=P(""),[j,c]=P("ethereum"),[p,v]=P([]),[u,x]=P(null),I=y.use.setDraftData(),w=y.use.resetChartPanelData(),C=y.use.tokenInfo(),M=y.use.indicatorList();React.useEffect(()=>{M&&I(_=>{const W=(Z=>{for(const Se of Z)for(const Me of Se.groups){const ie=Me.indicators.find(Ae=>Ae.handle_name===e);if(ie)return ie}return null})(M);if(W){_.indicatorInfo=W;const{param_schema:Z}=W||{};_.extra_params=pe(Z)}})},[M,I,e]);const{data:D=[]}=S(()=>Dt({key:h,chain:j}),{refreshDeps:[h,j],onSuccess:_=>{if(_){const A=_.find(W=>W.symbol===r&&a===W.chain);if(A&&(!C||C.symbol!==A.symbol)){x(A);return}}}});S(()=>u?Nt({symbol:u.symbol,chain:u.chain}):null,{refreshDeps:[u],onSuccess:_=>{v(_?Re(_):[])},onError:()=>{v([])}});const F=_=>{const A=new URLSearchParams(o);A.set("symbol",_.symbol),A.set("chain",_.chain),i(A),x(_),m(!1)},f=_=>{c(_),g("")},{run:J}=Xe(_=>{g(_)},{wait:200});React.useEffect(()=>{u&&(I(_=>{_.tokenInfo={symbol:u.symbol,chain:u.chain,create_time:u.create_time}}),l.current.resetFlag?l.current.resetFlag=!1:w({refreshChart:!0}))},[u]);const Ce=_=>{_&&(window.location.href=`/studio?symbol=${u.symbol}&handle_name=${_.handle_name}&chain=${u.chain}`)},Pe=n.jsxs("div",{className:k.tokenContent,children:[n.jsx(antd.Tabs,{defaultActiveKey:j,onChange:f,items:Nn,className:k.chainTabs}),n.jsx("div",{className:k.search,children:n.jsx(antd.Input,{onChange:_=>{J(_.target.value)},allowClear:!0,placeholder:"search by token name or symbol or address",style:{height:32,background:"#222324"},suffix:n.jsx(Je,{style:{color:"gray"}})})}),n.jsx("div",{className:k.content,children:D==null?void 0:D.map((_,A)=>n.jsxs("div",{className:k.item,onClick:()=>{F(_)},children:[n.jsx("div",{className:k.left,children:n.jsx("img",{src:_.icon_url,alt:""})}),n.jsxs("div",{className:k.right,children:[n.jsxs("div",{className:k.itemHeader,children:[n.jsx("span",{className:k.itemHeaderName,children:_.symbol}),n.jsx("span",{className:k.itemHeaderDesc,children:_.name})]}),n.jsx("div",{className:k.rightBottom,children:n.jsx(he,{className:k.contract_address,title:_.contract_address,children:_.contract_address})})]})]},A))})]});return n.jsxs("div",{className:k.header,children:[n.jsx("div",{className:k.leftWrapper,children:n.jsx(antd.Popover,{open:d,onOpenChange:_=>{m(_)},placement:"bottomLeft",content:Pe,trigger:["click"],children:n.jsx("div",{className:k.left,children:u?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:k.leftTop,children:[n.jsx("img",{className:k.logo,src:u==null?void 0:u.icon_url,alt:""}),n.jsx("p",{className:G(k.name,["common-ellipsis-1"]),children:u==null?void 0:u.name}),n.jsx(Ze,{style:{color:"rgba(255, 255, 255, 0.45)",fontWeight:"bolder"},className:k.arrow})]}),n.jsx(he,{className:k.leftBottom,title:u==null?void 0:u.contract_address,chain:u==null?void 0:u.chain,children:u==null?void 0:u.contract_address})]}):n.jsxs("div",{className:k.skeleton,children:[n.jsx(antd.Skeleton.Avatar,{style:{marginRight:10,width:18,height:18},active:!0,size:"small"}),n.jsx(antd.Skeleton.Input,{style:{width:160,height:18},active:!0,size:"small"}),n.jsx(antd.Skeleton.Input,{style:{width:191,height:10,marginTop:7},active:!0,size:"small"})]})})})}),n.jsx("div",{className:k.right,children:p==null?void 0:p.map((_,A)=>n.jsxs("div",{className:k.itemInfo,onClick:()=>Ce(_),children:[n.jsx("div",{className:k.title,children:_.title}),n.jsxs("div",{className:k.valueInfo,children:[n.jsx("span",{children:T(_.value)}),_.type!=="neutral"&&n.jsxs("span",{style:{color:_.type==="rise"?"#36F097":"#EB5757"},children:[_.type==="rise"?"+":"-",_.percentage]})]})]},A))})]})},On="_studio_1xu27_1",Bn="_segmented_1xu27_10",me={studio:On,segmented:Bn,"custom-tabs":"_custom-tabs_1xu27_15","ant-tabs-nav":"_ant-tabs-nav_1xu27_4","ant-tabs-tab":"_ant-tabs-tab_1xu27_18","ant-tabs-tab-btn":"_ant-tabs-tab-btn_1xu27_21"},$n=s=>N({url:"/data/api/wallet/topWallet",method:"POST",params:s}),Ln=s=>N({url:"/data/api/wallet/walletInfo",method:"POST",params:s}),En="_tableMask_m4ti0_1",Rn="_chartMask_m4ti0_16",zn="_upgradeContent_m4ti0_30",ee={tableMask:En,chartMask:Rn,upgradeContent:zn},we=({type:s})=>{const a=()=>{window.location.href="/pricing"},r=()=>s==="chart"?ee.chartMask:ee.tableMask;return n.jsx("div",{className:r(),children:n.jsxs("div",{className:ee.upgradeContent,children:[n.jsx("div",{children:Y.lock}),n.jsx(antd.Typography.Title,{level:4,children:"Unlock Full Access"}),n.jsx(antd.Typography.Paragraph,{children:"Upgrade your plan to view complete wallet data"}),n.jsx(antd.Button,{type:"primary",onClick:()=>a(),children:"Upgrade Now"})]})})},te=[{label:"3M",value:"3M",requiredLevel:0,disabled:!1},{label:"1Y",value:"1Y",requiredLevel:2,disabled:!0},{label:"ALL",value:"ALL",requiredLevel:3,disabled:!0}],Fn=s=>{if(!s)return te;for(const a of te)s>=a.requiredLevel?a.disabled=!1:a.disabled=!0;return te},Wn=({wallet_address:s})=>{const[a,r]=P([]),e=y.use.tokenInfo(),t=React.useRef([]),o=[],[i,l]=P([]),d=V(),[m,h]=P("3M"),g=Fn(d.level),j=()=>{switch(m){case"3M":return K();case"1Y":return ss();case"ALL":return e.create_time;default:return K()}},c=()=>d.level>1;S(()=>!e||!e.symbol||!e.chain?Promise.resolve([]):be({symbol:e.symbol,chain:e.chain,start_time:j(),end_time:""}),{refreshDeps:[e,m],onSuccess:u=>{l(u)}});const{loading:p}=S(()=>!e||!e.symbol||!e.chain?Promise.resolve([]):Ln({symbol:e.symbol,chain:e.chain,start_time:j(),wallet_address:s}),{refreshDeps:[e,m],onSuccess:u=>{r(()=>u)}}),v=(u,x,I,w,C)=>{if(!u.current)return;const M=echarts.init(u.current);return M.setOption({title:{text:x,left:"center"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:w},yAxis:[{type:"value",name:I[0].name,position:"left",splitLine:{show:!0,lineStyle:{color:"rgba(200, 200, 200, 0.4)",width:.3}}},{type:"value",name:"Index Price",position:"right",splitLine:{show:!1}}],series:I.map(D=>({name:D.name,type:D.name==="Index Price"?"line":C,data:D.data,smooth:!0,symbol:"none",yAxisIndex:D.yAxisIndex,lineStyle:D.name==="Index Price"?{color:"rgba(144, 238, 144, 0.3)"}:{},itemStyle:C==="bar"?{color:F=>F.value<0?"rgba(255, 127, 80, 0.8)":"rgba(30, 214, 255, 0.8)"}:{color:"rgba(30, 214, 255, 0.8)"}})),dataZoom:[{type:"slider",xAxisIndex:0,start:0,end:100},{type:"inside",xAxisIndex:0,start:0,end:100}]}),M};return React.useEffect(()=>{if(!a||a.length===0||!i||i.length===0)return;const u=i.map(f=>f==null?void 0:f.avg_price),x=i.map(f=>dayjs(f.time).format("YYYY-MM-DD")),I=i==null?void 0:i.length,w=$(a,I),C=w.map(f=>f==null?void 0:f.balance),M=w.map(f=>f==null?void 0:f.unrealized_pnl),D=w.map(f=>f==null?void 0:f.avg_cost),F=[v({current:t.current[0]},"Wallet Balance",[{name:"Balance",data:C,yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"line"),v({current:t.current[1]},"Balance Change",[{name:"Balance Change",data:w.map(f=>f==null?void 0:f.balance_chg),yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"bar"),v({current:t.current[2]},"Average Cost",[{name:"Average Cost",data:D,yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:0}],x,"line"),v({current:t.current[3]},"Unrealized PnL",[{name:"Unrealized PnL",data:M,yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"line"),v({current:t.current[4]},"Realized PnL",[{name:"Realized PnL",data:w.map(f=>f==null?void 0:f.realized_pnl),yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"bar"),v({current:t.current[5]},"Total PnL",[{name:"Total PnL",data:w.map(f=>f==null?void 0:f.total_pnl),yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"line"),v({current:t.current[6]},"Avg Token Day",[{name:"Avg Token Day",data:w.map(f=>f==null?void 0:f.avg_token_day),yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"line"),v({current:t.current[7]},"Token Day Destroyed",[{name:"Token Day Destroyed",data:w.map(f=>f==null?void 0:f.token_day_destory),yAxisIndex:0},{name:"Index Price",data:u,yAxisIndex:1}],x,"bar")];return F.forEach((f,J)=>{f&&(o[J]=f)}),echarts.connect(o),()=>{F.forEach(f=>f&&f.dispose())}},[a,i]),n.jsx(antd.Spin,{spinning:p,children:n.jsxs("div",{style:{padding:"20px",minHeight:"100vh",justifyContent:"center"},children:[n.jsx("div",{style:{marginBottom:"20px",display:"flex",justifyContent:"flex-end"},children:n.jsx(antd.Segmented,{options:g,value:m,onChange:u=>h(u)})}),!a||a.length===0?n.jsxs("div",{style:{textAlign:"center",fontSize:"18px",color:"#888"},children:["No data for this wallet with token ",e.symbol]}):[0,1,2,3,4,5,6,7].map((u,x)=>{const I=!c()&&x>=2&&x<=7;return n.jsxs("div",{style:{marginBottom:"20px",position:"relative"},children:[n.jsx("div",{ref:w=>t.current[x]=w,style:{width:"100%",height:"300px"}}),I?n.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(we,{type:"chart"})}):null]},x)})]})})},Un={TOP_50:50,TOP_100:100,TOP_500:500},se=[{label:"TOP_50",value:"TOP_50",requiredLevel:0,disabled:!1},{label:"TOP_100",value:"TOP_100",requiredLevel:2,disabled:!0},{label:"TOP_500",value:"TOP_500",requiredLevel:3,disabled:!0}],Hn=s=>{if(!s)return se;for(const a of se)s>=a.requiredLevel?a.disabled=!1:a.disabled=!0;return se},Gn=()=>{const[s,a]=P([]),r=y.use.tokenInfo(),e=ge(),t=V(),[o,i]=P("TOP_50"),l=Hn(t.level),{loading:d}=S(()=>!r||!r.symbol||!r.chain?Promise.resolve([]):$n({symbol:r.symbol,chain:r.chain,order_by:"balance",start_time:ns(1),top_count:Un[o]}),{refreshDeps:[r,o],onSuccess:c=>{a(()=>c)}}),m=c=>{e(`/studio?symbol=${r.symbol}&chain=${r.chain}&tab=wallet&wallet_address=${c.wallet_address}`)},h=()=>t.level>1,g=[{title:"Wallet Address",dataIndex:"wallet_address",key:"wallet_address",fixed:"left",width:100,render:c=>{const p=`${c.slice(0,6)}...${c.slice(-6)}`;return n.jsx(antd.Typography.Text,{copyable:{text:c},children:p})}},{title:"Balance",dataIndex:"balance",key:"balance",width:80,render:c=>T(c),sorter:(c,p)=>c.balance-p.balance},{title:"%",dataIndex:"percentage",key:"percentage",width:80,render:c=>`${T(c)}%`,sorter:(c,p)=>c.percentage-p.percentage},{title:"Balance USD",dataIndex:"balance_usd",key:"balance_usd",width:80,render:c=>T(c),sorter:(c,p)=>c.balance_usd-p.balance_usd},{title:"Avg Token/Day",dataIndex:"avg_token_day",key:"avg_token_day",width:80,render:c=>T(c),sorter:(c,p)=>c.avg_token_day-p.avg_token_day},{title:"Avg Cost",dataIndex:"avg_cost",key:"avg_cost",width:80,render:c=>T(c),sorter:(c,p)=>c.avg_cost-p.avg_cost},{title:"Total Cost",dataIndex:"total_cost",key:"total_cost",width:80,render:c=>T(c),sorter:(c,p)=>c.total_cost-p.total_cost},{title:"Total PNL",dataIndex:"total_pnl",key:"total_pnl",width:80,render:c=>n.jsx(antd.Typography.Text,{type:c>=0?"success":"danger",children:T(c)}),sorter:(c,p)=>c.total_pnl-p.total_pnl},{title:"Unrealized PNL",dataIndex:"unrealized_pnl",key:"unrealized_pnl",width:80,render:c=>n.jsx(antd.Typography.Text,{type:c>=0?"success":"danger",children:T(c)}),sorter:(c,p)=>c.unrealized_pnl-p.unrealized_pnl},{title:"Txs In",dataIndex:"tx_in_count",key:"tx_in_count",width:80,render:c=>c,sorter:(c,p)=>c.tx_in_count-p.tx_in_count},{title:"Txs Out",dataIndex:"tx_out_count",key:"tx_out_count",width:80,render:c=>c,sorter:(c,p)=>c.tx_out_count-p.tx_out_count},{title:"Win Rate",dataIndex:"win_rate",key:"win_rate",width:80,render:c=>`${T(c*100)}%`,sorter:(c,p)=>c.win_rate-p.win_rate},{title:"Txs",dataIndex:"total_txs",key:"total_txs",width:80,fixed:"right",render:c=>c,sorter:(c,p)=>c.total_txs-p.total_txs}],j=c=>{i(c)};return n.jsxs("div",{children:[n.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:n.jsx(antd.Segmented,{options:l,value:o,onChange:c=>j(c),disabled:d})}),n.jsx("style",{children:`
          .ant-table-cell {
            white-space: nowrap;
            padding: 8px 16px !important;
          }
          .ant-table-thead > tr > th {
            white-space: nowrap;
            padding: 12px 16px !important;
            height: 48px !important;
          }
          .ant-table-tbody > tr > td {
            line-height: 28px !important;
          }
          .ant-table-row {
            cursor: pointer;
          }
          .ant-table-row:hover {
            background-color: rgba(0, 0, 0, 0.02);
          }
          
          /* Ensure header remains clickable */
          .ant-table-header {
            z-index: 11;
            position: relative;
          }
        `}),n.jsx(antd.Table,{columns:g,dataSource:s,rowKey:"wallet_address",scroll:{x:1600,y:600},pagination:!1,loading:d,onRow:c=>({onClick:()=>m(c)}),sticky:!0}),!h()&&n.jsx(we,{type:"table"})]})},Vn="_wallet_1o9m5_1",qn="_top_1o9m5_8",Kn="_content_1o9m5_11",Xn={wallet:Vn,top:qn,content:Kn},Jn=()=>{const s=ze(),a=ge(),r=new URLSearchParams(s.search),e=r.get("wallet_address"),t=()=>{r.delete("wallet_address");const o=r.toString(),i=`${s.pathname}${o?`?${o}`:""}`;a(i)};return n.jsx("div",{className:Xn.wallet,children:e?n.jsxs("div",{children:[n.jsx(antd.Button,{type:"link",icon:n.jsx(re,{}),onClick:t,style:{position:"absolute",top:10,left:10,zIndex:1e3},children:"Back"}),n.jsx(Wn,{wallet_address:e})]}):n.jsx(Gn,{})})},Zn=[{key:"chart",label:"CHART",children:n.jsx(cn,{})},{key:"wallet",label:"WALLET",children:n.jsx(Jn,{})}],na=()=>{const[s,a]=ae(),r=(s.get("tab")||"chart").toLowerCase(),e=t=>{const o=new URLSearchParams(s);o.set("tab",t),t==="chart"&&(o.delete("wallet_address"),o.get("handle_name")||o.set("handle_name","holder.all")),a(o)};return n.jsxs("div",{className:me.studio,children:[n.jsx(Yn,{}),n.jsx(antd.Divider,{style:{margin:0}}),n.jsx(antd.Tabs,{className:me.customTabs,type:"line",defaultActiveKey:"chart",activeKey:r,items:Zn,onChange:e})]})};export{na as default};
